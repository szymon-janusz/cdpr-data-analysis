--------------------------------------------------------
--  File created - wtorek-lipca-15-2025   
--------------------------------------------------------
--------------------------------------------------------
--  DDL for View REVENUE_BY_QUARTER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CDPR_ANALYTICS"."REVENUE_BY_QUARTER" ("QUARTER_START", "TOTAL_REVENUE", "NOTES") AS 
  SELECT
  START_DATE AS quarter_start,
  REVENUE AS total_revenue,
  NOTES
FROM cdpr_revenue
WHERE START_DATE >= DATE '2020-10-01'
ORDER BY quarter_start
;
--------------------------------------------------------
--  DDL for View SENTIMENT_BY_QUARTER
--------------------------------------------------------

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "CDPR_ANALYTICS"."SENTIMENT_BY_QUARTER" ("QUARTER_START", "AVG_SENTIMENT", "REVIEW_COUNT") AS 
  SELECT
  TRUNC(CREATED_DATE, 'Q') AS quarter_start,
  ROUND(AVG(SENTIMENT),3) AS avg_sentiment,
  COUNT(*) AS review_count
FROM steam_reviews
WHERE CREATED_DATE >= DATE '2020-10-01'
GROUP BY TRUNC(CREATED_DATE, 'Q')
ORDER BY quarter_start
;
REM INSERTING into CDPR_ANALYTICS.REVENUE_BY_QUARTER
SET DEFINE OFF;
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-OCT-20','DD-MON-RR'),1540365,'Cyberpunk 2077 premiere');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JAN-21','DD-MON-RR'),145868,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-APR-21','DD-MON-RR'),221118,'Patch 1.2');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JUL-21','DD-MON-RR'),104262,'Patch 1.3');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-OCT-21','DD-MON-RR'),220316,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JAN-22','DD-MON-RR'),173787,'NextGen update for consoles');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-APR-22','DD-MON-RR'),112081,'Patch 1.5');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JUL-22','DD-MON-RR'),203189,'Announcement Phantom Liberty');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-OCT-22','DD-MON-RR'),278442,'Edgerunners');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JAN-23','DD-MON-RR'),130595,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-APR-23','DD-MON-RR'),107489,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JUL-23','DD-MON-RR'),390534,'Phantom Liberty premiere and Patch 2.0');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-OCT-23','DD-MON-RR'),413166,'Peak sales of the DLC and Patch 2.1');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JAN-24','DD-MON-RR'),185591,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-APR-24','DD-MON-RR'),157238,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JUL-24','DD-MON-RR'),180158,null);
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-OCT-24','DD-MON-RR'),274409,'Patch 2.2');
Insert into CDPR_ANALYTICS.REVENUE_BY_QUARTER (QUARTER_START,TOTAL_REVENUE,NOTES) values (to_date('01-JAN-25','DD-MON-RR'),179832,null);
REM INSERTING into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER
SET DEFINE OFF;
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-OCT-20','DD-MON-RR'),0.674,104044);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JAN-21','DD-MON-RR'),0.554,22426);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-APR-21','DD-MON-RR'),0.458,6550);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JUL-21','DD-MON-RR'),0.519,5197);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-OCT-21','DD-MON-RR'),0.699,10612);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JAN-22','DD-MON-RR'),0.688,7508);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-APR-22','DD-MON-RR'),0.759,4395);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JUL-22','DD-MON-RR'),0.792,8920);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-OCT-22','DD-MON-RR'),0.853,15171);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JAN-23','DD-MON-RR'),0.773,7519);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-APR-23','DD-MON-RR'),0.749,5973);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JUL-23','DD-MON-RR'),0.803,11284);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-OCT-23','DD-MON-RR'),0.858,18900);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JAN-24','DD-MON-RR'),0.863,10345);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-APR-24','DD-MON-RR'),0.882,8639);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JUL-24','DD-MON-RR'),0.871,8151);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-OCT-24','DD-MON-RR'),0.884,10165);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JAN-25','DD-MON-RR'),0.892,11734);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-APR-25','DD-MON-RR'),0.876,8394);
Insert into CDPR_ANALYTICS.SENTIMENT_BY_QUARTER (QUARTER_START,AVG_SENTIMENT,REVIEW_COUNT) values (to_date('01-JUL-25','DD-MON-RR'),0.857,1014);
